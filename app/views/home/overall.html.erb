<%- if user_signed_in? %>
    $('.js-user-info').html("<%= escape_javascript(render(:partial => "user-info")) %>");
    $('.navTop .login').hide();
    $('.navTop .reg').hide();
<%- end %>

$(function () {

//订阅电子期刊
if ($(".subscribe")) {
    $(".subscribe").click(function (event) {
        <% if current_user -%>
        o_in();
        $('#july_last').show().find('input[type=text]').val('');
        $('.subs_err').hide();
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

//礼从天降登陆身份验证
if ($("#gift_login")) {
    $("#gift_login").click(function (event) {
        <% if current_user && !(current_user.common_user?) -%>
        return true;
        <% elsif current_user && current_user.common_user? -%>
        alert("抱歉！普通用户身份是无法上传作品的哦！");
        return false;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#per_form")) {
    $("#per_form").submit(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#new_message")) {
    $("#new_message").submit(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#new_reply_msg")) {
    $("#new_reply_msg").submit(function (event) {
        <% if current_user -%>
        var $area = $('#reply_msg_content')
        var txt = $area.val();
        if (txt == '') {
            inputBlank($area);
            return false;
        }
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#new_faq")) {
    $("#new_faq").submit(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#new_site_message")) {
    $("#new_site_message").submit(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        $('.server_input').hide();
        $('.server_suc').hide();
        return false;
        <% end -%>
    });
}

if ($("#channel_service")) {
    $("#channel_service").submit(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#channel_access")) {
    $("#channel_access").click(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($(".one_key_forward")) {
    $(".one_key_forward").click(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($("#ckepop a")) {
    $("#ckepop a").click(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

if ($(".new_mix_color")) {
    $(".new_mix_color").click(function (event) {
        <% if current_user -%>
        return true;
        <% else -%>
        show_login();
        return false;
        <% end -%>
    });
}

});

function yda_kv_link () {
    <% if current_user && current_user.role_id == 1 -%>
        window.location.href = "<%= new_user_design_path(current_user) %>";
    <% elsif current_user %>
        window.location.href = "javascript:void(0)";
    <% else -%>
        show_login();
    <% end -%>
}